---
# tasks file for NoviNano
- name: install prerequisites
  apt: name=aptitude update_cache=yes state=latest force_apt_get=yes

- name: clone git repo
  git:
    repo: "https://github.com/mplesha/NoviNano.git"
    dest: /home/ansible/NoviNano

- name: move directory to web
  shell: "mv /home/ansible/NoviNano/mt/* /var/www/{{ http_host }}/"

#- name: install site
#  uri:
#    url: https://github.com/mplesha/NoviNano/releases/download/v1.0/20180706_novinano_mr_9d7561b2584268389437180706072703_archive.zip
#    dest: /var/www/{{ http_host }}/

#- name: add installer
#  uri:
#    url: https://github.com/mplesha/NoviNano/releases/download/v1.0/20180706_novinano_mr_301b6110dc5ef0dd6130180706071745_installer.php
#    dest: /var/www/{{ http_host }}/

- name: set rights for site folder
  file:
     path: /var/www/{{ http_host }}
     state: directory
     recurse: yes
     owner: www-data
     group: www-data

- name: Set permissions for directories
  shell: "/usr/bin/find /var/www/{{ http_host }} -type d -exec chmod 750 {} \\;"

- name: Set permissions for files
  shell: "/usr/bin/find /var/www/{{ http_host }} -type f -exec chmod 640 {} \\;"
